domain: kitchen
requirements: [":strips", ":typing"]

types:
  - name: robot
  - name: location
  - name: object
  - name: container
    parent: object
  - name: appliance
    parent: object
  - name: number

predicates:
  - name: co-located
    args: [{name: x, type: object}, {name: y, type: object}]
    nl: "x and y share a location"

  - name: at
    args: [{name: r, type: robot}, {name: l, type: location}]
    nl: "{r} is at {l}"

  - name: obj-at
    args: [{name: o, type: object}, {name: l, type: location}]
    nl: "{o} is at {l}"

  - name: holding
    args: [{name: r, type: robot}, {name: o, type: object}]
    nl: "{r} is holding {o}"

  - name: clear-hand
    args: [{name: r, type: robot}]
    nl: "{r} has a free hand"

  - name: in
    args: [{name: o, type: object}, {name: c, type: container}]
    nl: "{o} is in {c}"

  - name: open
    args: [{name: c, type: container}]
    nl: "{c} is open"

  - name: powered
    args: [{name: a, type: appliance}]
    nl: "{a} is powered"

  - name: boiled
    args: [{name: a, type: appliance}]
    nl: "{a} has boiled water"

  - name: has-hot-water
    args: [{name: m, type: container}]
    nl: "{m} contains hot water"

  - name: tea-ready
    args: [{name: m, type: container}]
    nl: "Tea is ready in {m}"

  - name: spilled
    args: [{name: m, type: container}]
    nl: "There was a spill at {m}"

  - name: has-charger
    args: [{name: l, type: location}]
    static: true
    nl: "{l} has a charging station"

  - name: adjacent
    args: [{name: l1, type: location}, {name: l2, type: location}]
    static: true
    nl: "{l1} is adjacent to {l2}"

  - name: needs-open
    args: [{name: c, type: container}]
    static: true
    nl: "{c} requires opening to pour"

  - name: openable
    args: [{name: c, type: container}]
    static: true
    nl: "{c} can be opened/closed"

# ---------- Fluents (numeric state) ----------
fluents:

  - name: energy
    args: [{name: r, type: robot}]
    nl: "Energy of {r}"

  - name: battery-cap
    args: [{name: r, type: robot}]
    nl: "Battery capacity of {r}"

  - name: water-temp
    args: [{name: v, type: container}]
    nl: "Water temperature in {v}"

# ---------- Actions ----------
actions:

  - name: wait
    params: [{n: number}]
    pre: []
    add: []
    del: []
    duration_var: "n"
    duration_unit: 1.0
    nl: "Wait for {n} ticks"
    messages:
      - "Waited {n} ticks."

  - name: move
    params: [{r: robot}, {from: location}, {to: location}]
    pre:
      - "(at ?r ?from)"
      - "(adjacent ?from ?to)"
      - "(>= (energy ?r) 1)"
      - "(distinct ?from ?to)"
    add: ["(at ?r ?to)"]
    del: ["(at ?r ?from)"]
    num_eff: ["(decrease (energy ?r) 1)"]
    duration: 1.0
    nl: "Move {r} from {from} to {to}"
    messages:
      - "{r} moved from {from} to {to}. Energy is now (energy ?r)."

  - name: open
    params: [{r: robot}, {c: container}]
    pre: ["(co-located ?r ?c)", "(openable ?c)", "(not (open ?c))"]
    add: ["(open ?c)"]
    num_eff: ["(decrease (energy ?r) 0.2)"]
    duration: 0.5
    nl: "Open {c}"
    messages:
      - "{c} is now open."


  - name: close
    params: [{r: robot}, {c: container}]
    pre: ["(co-located ?r ?c)", "(openable ?c)", "(open ?c)"]
    del: ["(open ?c)"]
    num_eff: ["(decrease (energy ?r) 0.2)"]
    duration: 0.5
    nl: "Close {c}"
    messages:
      - "{c} is now closed."


  - name: pick-up
    params: [{r: robot}, {o: object}]
    pre: ["(co-located ?r ?o)", "(clear-hand ?r)"]
    add: ["(holding ?r ?o)"]
    del: ["(obj-at ?o ?l)", "(clear-hand ?r)"]
    num_eff: ["(decrease (energy ?r) 0.3)"]
    duration: 0.5
    nl: "Pick up {o}"
    messages:
      - "Picked up {o}."


  - name: put-down
    params: [{r: robot}, {o: object}]
    pre: ["(holding ?r ?o)"]
    add: ["(obj-at ?o ?l)", "(clear-hand ?r)"]
    del: ["(holding ?r ?o)"]
    num_eff: ["(decrease (energy ?r) 0.3)"]
    duration: 0.5
    nl: "Put down {o}"
    messages:
      - "Placed {o} down."


  - name: put-in
    params: [{r: robot}, {o: object}, {c: container}]
    pre:
      - "(co-located ?r ?c)"
      - "(holding ?r ?o)"
      - "(or (not (needs-open ?c)) (open ?c))"
    add: ["(in ?o ?c)", "(clear-hand ?r)"]
    del: ["(holding ?r ?o)", "(obj-at ?o ?l)"]
    num_eff: ["(decrease (energy ?r) 0.3)"]
    duration: 0.5
    nl: "Put {o} into {c}"
    messages:
      - "{o} is now in {c}."


  - name: take-out
    params: [{r: robot}, {o: object}, {c: container}]
    pre:
      - "(clear-hand ?r)"
      - "(co-located ?r ?c)"
      - "(in ?o ?c)"
      - "(or (not (needs-open ?c)) (open ?c))"
    add: ["(holding ?r ?o)"]
    del: ["(in ?o ?c)", "(clear-hand ?r)"]
    num_eff: ["(decrease (energy ?r) 0.3)"]
    duration: 0.5
    nl: "Take {o} out of {c}"
    messages:
      - "Took {o} out of {c}."


  - name: power-on
    params: [{r: robot}, {a: appliance}]
    pre: ["(co-located ?r ?a)", "(not (powered ?a))"]
    add: ["(powered ?a)"]
    num_eff: ["(decrease (energy ?r) 0.2)"]
    duration: 0.5
    nl: "Power on {a}"
    messages:
      - "{a} is now powered."


  - name: heat-kettle
    params: [{r: robot}, {k: appliance}, {n: number}]
    pre:
      - "(co-located ?r ?k)"
      - "(powered ?k)"
      - "(not (open ?k))"
    num_eff: ["(increase (water-temp ?k) 15*?n)"]
    duration_var: "n"
    duration_unit: 0.5
    nl: "Heat {k} for {n} ticks (each tick increases water temp by 15°C)"
    messages:
      - "Heating {k}. Water temperature is now (water-temp ?k)°C."

  - name: pour
    params: [{r: robot}, {k: container}, {m: container}]
    pre:
      - "(co-located ?r ?k)"
      - "(co-located ?r ?m)"
      - "(or (not (needs-open ?k)) (open ?k))"
      - "(distinct ?k ?m)"
    cond:
      - when: ["(needs-open ?m)", "(not (open ?m))"]
        add: ["(spilled ?m)"]
        del: ["(has-hot-water ?m)"]
        messages:
          - "You tried to pour into {m} while {m} was closed. You first need to open {m}."
      - when:
          - "(or (not (needs-open ?m)) (open ?m))"
          - "(>= (water-temp ?k) 80)"
        add: ["(has-hot-water ?m)"]
        num_eff: ["(assign (water-temp ?m) 100)"]
        messages:
          - "Hot water transferred to {m}."
    duration: 1.0
    nl: "Pour from {k} into {m}"

  - name: steep-tea
    params: [{r: robot}, {tb: object}, {m: container}]
    pre: ["(co-located ?r ?m)", "(in ?tb ?m)", "(>= (water-temp ?m) 80)"]
    add: ["(tea-ready ?m)"]
    del: ["(spilled ?m)"]
    num_eff: ["(decrease (energy ?r) 0.5)"]
    duration: 2.0
    nl: "Steep tea in {m} (requires water ≥80°C)"
    messages:
      - "Tea steeped. {m} is ready."


  - name: recharge
    params: [{r: robot}, {l: location}]
    pre: ["(at ?r ?l)", "(has-charger ?l)"]
    num_eff: ["(increase (energy ?r) 5)"]
    duration: 2.0
    nl: "Recharge at {l}"
    messages:
      - "{r} recharged at {l}. Energy is now (energy ?r)."
