domain: kitchen
requirements: [":strips", ":typing"]

types:
  - name: robot
  - name: location
  - name: object
  - name: container
    parent: object
  - name: appliance
    parent: object
  - name: number

predicates:
  - name: co-located
    args: [{name: x, type: object}, {name: y, type: object}]
    nl:
      - "{x} and {y} share a location"
      - "{x} is at the same place as {y}"
      - "{x} and {y} are co-located"

  - name: at
    args: [{name: r, type: robot}, {name: l, type: location}]
    nl:
      - "{r} is at {l}"
      - "{r} stands in {l}"
      - "{r} is located at {l}"

  - name: obj-at
    args: [{name: o, type: object}, {name: l, type: location}]
    nl:
      - "{o} is at {l}"
      - "{o} sits in {l}"
      - "{o} is located at {l}"

  - name: holding
    args: [{name: r, type: robot}, {name: o, type: object}]
    nl:
      - "{r} is holding {o}"
      - "{r} has {o} in hand"
      - "{r} grips {o}"

  - name: clear-hand
    args: [{name: r, type: robot}]
    nl:
      - "{r} has a free hand"
      - "{r}'s hand is free"
      - "{r} is not holding anything"

  - name: in
    args: [{name: o, type: object}, {name: c, type: container}]
    nl:
      - "{o} is in {c}"
      - "{o} sits inside {c}"
      - "{o} is contained in {c}"

  - name: open
    args: [{name: c, type: container}]
    nl:
      - "{c} is open"
      - "{c} stands open"
      - "{c} is currently open"

  - name: powered
    args: [{name: a, type: appliance}]
    nl:
      - "{a} is powered"
      - "{a} has power"
      - "{a} is turned on"

  - name: boiled
    args: [{name: a, type: appliance}]
    nl:
      - "{a} has boiled water"
      - "Water has boiled in {a}"
      - "{a} finished boiling"

  - name: has-hot-water
    args: [{name: m, type: container}]
    nl:
      - "{m} contains hot water"
      - "Hot water is in {m}"
      - "{m} has hot water"

  - name: tea-ready
    args: [{name: m, type: container}]
    nl:
      - "Tea is ready in {m}"
      - "{m} contains ready tea"
      - "Tea in {m} is ready"

  - name: spilled
    args: [{name: m, type: container}]
    nl:
      - "There was a spill at {m}"
      - "Liquid spilled at {m}"
      - "{m} had a spill"

  - name: has-charger
    args: [{name: l, type: location}]
    static: true
    nl:
      - "{l} has a charging station"
      - "A charger is available at {l}"
      - "{l} provides charging"

  - name: adjacent
    args: [{name: l1, type: location}, {name: l2, type: location}]
    static: true
    nl:
      - "{l1} is adjacent to {l2}"
      - "{l1} neighbors {l2}"
      - "{l1} is next to {l2}"

  - name: needs-open
    args: [{name: c, type: container}]
    static: true
    nl:
      - "{c} requires opening to pour"
      - "{c} must be open to pour"
      - "Pouring needs {c} to be open"

  - name: openable
    args: [{name: c, type: container}]
    static: true
    nl:
      - "{c} can be opened/closed"
      - "{c} is openable"
      - "{c} supports open/close"

  - name: has-water
    args: [{name: c, type: container}]
    nl:
      - "{c} contains water"
      - "Water is present in {c}"

  - name: is-sink
    args: [{name: s, type: container}]
    static: true
    nl:
      - "{s} is a sink/water source"
      - "{s} can supply water"

# ---------- Fluents (numeric state) ----------
fluents:

  - name: energy
    args: [{name: r, type: robot}]
    nl:
      - "Energy of {r}"
      - "{r}'s energy level"
      - "Battery level for {r}"

  - name: battery-cap
    args: [{name: r, type: robot}]
    nl:
      - "Battery capacity of {r}"
      - "{r}'s maximum battery"
      - "Max energy for {r}"

  - name: water-temp
    args: [{name: v, type: container}]
    nl:
      - "Water temperature in {v}"
      - "{v}'s water temperature"
      - "Temperature of water in {v}"

# ---------- Actions ----------
actions:

  - name: wait
    params: [{n: number}]
    pre: []
    add: []
    del: []
    duration_var: "n"
    duration_unit: 1.0
    nl:
      - "Wait for {n} ticks"
      - "Pause {n} ticks"
      - "Idle for {n} ticks"
    outcomes:
      - name: fail
        p: 0.00
        when: []
        add: []
        delete: []
        messages:
          - "You tried to wait, and… nothing failed. (As designed.)"
      - name: success
        p: 1.00
        when: []
        add: []
        delete: []
        messages:
          - "Waited {n} ticks."

  - name: move
    params: [{r: robot}, {from: location}, {to: location}]
    pre:
      - "(at ?r ?from)"
      - "(adjacent ?from ?to)"
      - "(>= (energy ?r) 1)"
      - "(distinct ?from ?to)"
    add: []
    del: []
    num_eff: []
    duration: 1.0
    nl:
      - "Move {r} from {from} to {to}"
      - "Go from {from} to {to} with {r}"
      - "{r} moves {from} → {to}"
    outcomes:
      - name: fail
        p: 0.05
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "{r} tried to move from {from} to {to} but got stuck. No progress."
      - name: success
        p: 0.95
        when: []
        add: ["(at ?r ?to)"]
        delete: ["(at ?r ?from)"]
        num_eff: ["(decrease (energy ?r) 1)"]
        messages:
          - "{r} moved from {from} to {to}. Energy is now (energy ?r)."

  - name: open
    params: [{r: robot}, {c: container}]
    pre: ["(co-located ?r ?c)", "(openable ?c)", "(not (open ?c))"]
    add: []
    del: []
    duration: 0.5
    nl:
      - "Open {c}"
      - "{r} opens {c}"
      - "Open the {c}"
    outcomes:
      - name: fail
        p: 0.05
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "You fumbled with {c}. Still closed."
      - name: success
        p: 0.95
        when: []
        add: ["(open ?c)"]
        delete: []
        num_eff: ["(decrease (energy ?r) 0.2)"]
        messages:
          - "{c} is now open."

  - name: close
    params: [{r: robot}, {c: container}]
    pre: ["(co-located ?r ?c)", "(openable ?c)", "(open ?c)"]
    add: []
    del: []
    duration: 0.5
    nl:
      - "Close {c}"
      - "{r} closes {c}"
      - "Shut {c}"
    outcomes:
      - name: fail
        p: 0.05
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "You tried to close {c} but it didn’t latch."
      - name: success
        p: 0.95
        when: []
        add: []
        delete: ["(open ?c)"]
        num_eff: ["(decrease (energy ?r) 0.2)"]
        messages:
          - "{c} is now closed."

  - name: pick-up
    params: [{r: robot}, {o: object}]
    pre: ["(co-located ?r ?o)", "(clear-hand ?r)"]
    add: []
    del: []
    duration: 0.5
    nl:
      - "Pick up {o}"
      - "{r} picks up {o}"
      - "Grab {o}"
    outcomes:
      - name: fail
        p: 0.10
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "You fumbled {o}. Try again."
      - name: success
        p: 0.90
        when: []
        add: ["(holding ?r ?o)"]
        delete: ["(obj-at ?o ?l)", "(clear-hand ?r)"]
        num_eff: ["(decrease (energy ?r) 0.3)"]
        messages:
          - "Picked up {o}."

  - name: put-down
    params: [{r: robot}, {o: object}]
    pre: ["(holding ?r ?o)"]
    add: []
    del: []
    duration: 0.5
    nl:
      - "Put down {o}"
      - "{r} puts down {o}"
      - "Place {o} down"
    outcomes:
      - name: fail
        p: 0.07
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "{o} slipped; still in hand."
      - name: success
        p: 0.93
        when: []
        add: ["(obj-at ?o ?l)", "(clear-hand ?r)"]
        delete: ["(holding ?r ?o)"]
        num_eff: ["(decrease (energy ?r) 0.3)"]
        messages:
          - "Placed {o} down."

  - name: put-in
    params: [{r: robot}, {o: object}, {c: container}]
    pre:
      - "(co-located ?r ?c)"
      - "(holding ?r ?o)"
      - "(or (not (needs-open ?c)) (open ?c))"
    add: []
    del: []
    duration: 0.5
    nl:
      - "Put {o} into {c}"
      - "{r} inserts {o} into {c}"
      - "Place {o} in {c}"
    outcomes:
      - name: fail
        p: 0.10
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "Missed the opening on {c}. Try again."
      - name: success
        p: 0.90
        when: []
        add: ["(in ?o ?c)", "(clear-hand ?r)"]
        delete: ["(holding ?r ?o)", "(obj-at ?o ?l)"]
        num_eff: ["(decrease (energy ?r) 0.3)"]
        messages:
          - "{o} is now in {c}."

  - name: take-out
    params: [{r: robot}, {o: object}, {c: container}]
    pre:
      - "(clear-hand ?r)"
      - "(co-located ?r ?c)"
      - "(in ?o ?c)"
      - "(or (not (needs-open ?c)) (open ?c))"
    add: []
    del: []
    duration: 0.5
    nl:
      - "Take {o} out of {c}"
      - "{r} removes {o} from {c}"
      - "Retrieve {o} from {c}"
    outcomes:
      - name: fail
        p: 0.10
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "You couldn’t get a grip on {o} in {c}."
      - name: success
        p: 0.90
        when: []
        add: ["(holding ?r ?o)"]
        delete: ["(in ?o ?c)", "(clear-hand ?r)"]
        num_eff: ["(decrease (energy ?r) 0.3)"]
        messages:
          - "Took {o} out of {c}."

  - name: power-on
    params: [{r: robot}, {a: appliance}]
    pre: ["(co-located ?r ?a)", "(not (powered ?a))"]
    add: []
    del: []
    duration: 0.5
    nl:
      - "Power on {a}"
      - "{r} turns on {a}"
      - "Switch on {a}"
    outcomes:
      - name: fail
        p: 0.02
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.05)"]
        messages:
          - "Power button on {a} didn’t register."
      - name: success
        p: 0.98
        when: []
        add: ["(powered ?a)"]
        delete: []
        num_eff: ["(decrease (energy ?r) 0.2)"]
        messages:
          - "{a} is now powered."

  - name: fill-water
    params: [{r: robot}, {k: container}, {s: container}]
    pre:
      - "(co-located ?r ?k)"
      - "(co-located ?r ?s)"
      - "(is-sink ?s)"
      - "(open ?k)"
    add: []
    del: []
    duration: 1.0
    nl:
      - "Fill {k} with water from {s}"
      - "{r} fills {k} at {s}"
    outcomes:
      - name: fail
        p: 0.05
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "The faucet sputtered; {k} didn’t fill."
      - name: success
        p: 0.95
        when: []
        add: ["(has-water ?k)"]
        delete: []
        num_eff:
          - "(assign (water-temp ?k) 20)"
          - "(decrease (energy ?r) 0.2)"
        messages:
          - "{k} is now filled with water (20°C)."

  - name: heat-kettle
    params: [{r: robot}, {k: appliance}, {n: number}]
    pre:
      - "(co-located ?r ?k)"
      - "(powered ?k)"
      - "(has-water ?k)"
      - "(not (open ?k))"
    add: []
    del: []
    duration_var: "n"
    duration_unit: 0.5
    nl:
      - "Heat {k} for {n} ticks (each tick increases water temp by 15°C)"
      - "Run {k} for {n} ticks (+15°C per tick)"
      - "Heat cycle on {k}: {n} ticks"
    outcomes:
      - name: fail
        p: 0.05
        when: []
        add: []
        delete: []
        num_eff: []
        messages:
          - "Heating cycle on {k} failed to start."
      - name: success
        p: 0.95
        when: []
        add: []
        delete: []
        num_eff: ["(increase (water-temp ?k) 15*?n)"]
        messages:
          - "Heating {k}. Water temperature is now (water-temp ?k)°C."

  - name: pour
    params: [{r: robot}, {k: container}, {m: container}]
    pre:
      - "(co-located ?r ?k)"
      - "(co-located ?r ?m)"
      - "(or (not (needs-open ?k)) (open ?k))"
      - "(distinct ?k ?m)"
    outcomes:
      - name: spill
        when: ["(needs-open ?m)", "(not (open ?m))"]
        add: ["(spilled ?m)"]
        delete: ["(has-hot-water ?m)"]
        messages:
          - "You tried to pour into {m} while {m} was closed. You first need to open {m}."
        p: 1.0
      - name: success
        when:
          - "(or (not (needs-open ?m)) (open ?m))"
          - "(>= (water-temp ?k) 80)"
          - "(has-water ?k)"
        add: ["(has-hot-water ?m)"]
        delete: ["(has-water ?k)"]
        num_eff: ["(assign (water-temp ?m) 100)"]
        messages:
          - "Hot water transferred to {m}."
        p: 1.0
    duration: 1.0
    nl:
      - "Pour from {k} into {m}"
      - "{r} pours {k} into {m}"
      - "Transfer hot water {k} → {m}"

  - name: steep-tea
    params: [{r: robot}, {tb: object}, {m: container}]
    pre: ["(co-located ?r ?m)", "(in ?tb ?m)", "(>= (water-temp ?m) 80)"]
    add: []
    del: []
    duration: 2.0
    nl:
      - "Steep tea in {m} (requires water ≥80°C)"
      - "Steep {tb} in {m} (water ≥80°C)"
      - "Brew tea in {m} (≥80°C)"
    outcomes:
      - name: fail
        p: 0.08
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.2)"]
        messages:
          - "Steeping failed—bag tore or drifted. Try again."
      - name: success
        p: 0.92
        when: []
        add: ["(tea-ready ?m)"]
        delete: ["(spilled ?m)"]
        num_eff: ["(decrease (energy ?r) 0.5)"]
        messages:
          - "Tea steeped. {m} is ready."

  - name: recharge
    params: [{r: robot}, {l: location}]
    pre: ["(at ?r ?l)", "(has-charger ?l)"]
    add: []
    del: []
    duration: 2.0
    nl:
      - "Recharge at {l}"
      - "{r} recharges at {l}"
      - "Use charger at {l}"
    outcomes:
      - name: fail
        p: 0.02
        when: []
        add: []
        delete: []
        num_eff: []
        messages:
          - "Charger at {l} didn’t connect properly."
      - name: success
        p: 0.98
        when: []
        add: []
        delete: []
        num_eff: ["(increase (energy ?r) 5)"]
        messages:
          - "{r} recharged at {l}. Energy is now (energy ?r)."
