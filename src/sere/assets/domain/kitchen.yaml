domain: kitchen
requirements: [":strips", ":typing"]

types:
  - name: robot
  - name: location
  - name: object
  - name: movable
    parent: object
  - name: container
    parent: movable
  - name: appliance
    parent: object
  - name: stove
    parent: appliance
  - name: cookware
    parent: container
  - name: food
    parent: movable
  - name: number

predicates:
  - name: co-located
    args: [{name: x, type: object}, {name: y, type: object}]
    nl:
      - "{x} and {y} share a location"
      - "{x} is at the same place as {y}"
      - "{x} and {y} are co-located"

  - name: at
    args: [{name: r, type: robot}, {name: l, type: location}]
    nl:
      - "{r} is at {l}"
      - "{r} stands in {l}"
      - "{r} is located at {l}"

  - name: obj-at
    args: [{name: o, type: object}, {name: l, type: location}]
    nl:
      - "{o} is at {l}"
      - "{o} sits in {l}"
      - "{o} is located at {l}"

  - name: holding
    args: [{name: r, type: robot}, {name: o, type: object}]
    nl:
      - "{r} is holding {o}"
      - "{r} has {o} in hand"
      - "{r} grips {o}"

  - name: clear-hand
    args: [{name: r, type: robot}]
    nl:
      - "{r} has a free hand"
      - "{r}'s hand is free"
      - "{r} is not holding anything"

  - name: in
    args: [{name: o, type: object}, {name: c, type: container}]
    nl:
      - "{o} is in {c}"
      - "{o} sits inside {c}"
      - "{o} is contained in {c}"

  - name: open
    args: [{name: c, type: container}]
    nl:
      - "{c} is open"
      - "{c} stands open"
      - "{c} is currently open"

  - name: powered
    args: [{name: a, type: appliance}]
    nl:
      - "{a} is powered"
      - "{a} has power"
      - "{a} is turned on"

  - name: burner-on
    args: [{name: s, type: stove}]
    nl:
      - "{s}'s burner is on"
      - "{s} is actively heating"
      - "{s} is heating"

  - name: on-stove
    args: [{name: c, type: cookware}, {name: s, type: stove}]
    nl:
      - "{c} sits on {s}"
      - "{c} is on the stove {s}"
      - "{c} is placed on {s}"

  - name: hot-surface
    args: [{name: s, type: stove}]
    nl:
      - "{s} has a hot surface"
      - "{s} is hot to the touch"
      - "{s}'s surface is hot"

  - name: boiled
    args: [{name: a, type: appliance}]
    nl:
      - "{a} has boiled water"
      - "Water has boiled in {a}"
      - "{a} finished boiling"

  - name: has-water
    args: [{name: c, type: container}]
    nl:
      - "{c} contains water"
      - "Water is present in {c}"

  - name: has-hot-water
    args: [{name: m, type: container}]
    nl:
      - "{m} contains hot water"
      - "Hot water is in {m}"
      - "{m} has hot water"

  - name: tea-ready
    args: [{name: m, type: container}]
    nl:
      - "Tea is ready in {m}"
      - "{m} contains ready tea"
      - "Tea in {m} is ready"

  - name: cooked
    args: [{name: f, type: food}]
    nl:
      - "{f} is cooked"
      - "{f} is fully cooked"
      - "{f} is ready to eat"

  - name: spilled
    args: [{name: m, type: container}]
    nl:
      - "There was a spill at {m}"
      - "Liquid spilled at {m}"
      - "{m} had a spill"

  - name: has-charger
    args: [{name: l, type: location}]
    static: true
    nl:
      - "{l} has a charging station"
      - "A charger is available at {l}"
      - "{l} provides charging"

  - name: adjacent
    args: [{name: l1, type: location}, {name: l2, type: location}]
    static: true
    nl:
      - "{l1} is adjacent to {l2}"
      - "{l1} neighbors {l2}"
      - "{l1} is next to {l2}"

  - name: openable
    args: [{name: c, type: container}]
    static: true
    nl:
      - "{c} can be opened/closed"
      - "{c} is openable"
      - "{c} supports open/close"

  - name: is-sink
    args: [{name: s, type: container}]
    static: true
    nl:
      - "{s} is a sink/water source"
      - "{s} can supply water"

  # Role-specific pour constraints
  - name: pour-out-needs-open
    args: [{name: c, type: container}]
    static: true
    nl:
      - "{c} must be open to pour out"
      - "Pouring out of {c} requires opening"

  - name: pour-out-needs-closed
    args: [{name: c, type: container}]
    static: true
    nl:
      - "{c} must be closed to pour out"
      - "Pouring out of {c} requires it closed"

  - name: pour-in-needs-open
    args: [{name: c, type: container}]
    static: true
    nl:
      - "{c} must be open to pour into"
      - "Pouring into {c} requires opening"

# ---------- Derived predicates ----------
derived:
  - head: "(co-located ?x ?y)"
    when:
      - "(and (at ?x ?l) (at ?y ?l))"
  - head: "(co-located ?x ?y)"
    when:
      - "(and (at ?x ?l) (obj-at ?y ?l))"
  - head: "(co-located ?x ?y)"
    when:
      - "(and (obj-at ?x ?l) (at ?y ?l))"
  - head: "(co-located ?x ?y)"
    when:
      - "(and (obj-at ?x ?l) (obj-at ?y ?l))"
  - head: "(co-located ?x ?y)"
    when:
      - "(and (in ?x ?c) (co-located ?c ?y))"
  - head: "(co-located ?x ?y)"
    when:
      - "(and (in ?y ?c) (co-located ?x ?c))"
  - head: "(co-located ?x ?y)"
    when:
      - "(and (holding ?r ?x) (co-located ?r ?y))"
  - head: "(co-located ?x ?y)"
    when:
      - "(and (holding ?r ?y) (co-located ?x ?r))"
  - head: "(boiled ?a)"
    when:
      - "(and (has-water ?a) (>= (water-temp ?a) 100))"
  - head: "(hot-surface ?s)"
    when:
      - "(>= (surface-temp ?s) 120)"
  - head: "(cooked ?f)"
    when:
      - "(>= (food-temp ?f) 70)"

fluents:
  - name: energy
    args: [{name: r, type: robot}]
    nl:
      - "Energy of {r}"
      - "{r}'s energy level"
      - "Battery level for {r}"

  - name: battery-cap
    args: [{name: r, type: robot}]
    nl:
      - "Battery capacity of {r}"
      - "{r}'s maximum battery"
      - "Max energy for {r}"

  - name: water-temp
    args: [{name: v, type: container}]
    nl:
      - "Water temperature in {v}"
      - "{v}'s water temperature"
      - "Temperature of water in {v}"

  - name: surface-temp
    args: [{name: s, type: stove}]
    nl:
      - "Surface temperature of {s}"
      - "{s}'s surface temperature"
      - "Heat level of {s}"

  - name: food-temp
    args: [{name: f, type: food}]
    nl:
      - "Temperature of {f}"
      - "{f}'s temperature"
      - "Heat of {f}"

actions:

  - name: wait
    params: [{n: number}]
    pre: []
    add: []
    del: []
    duration_var: "n"
    duration_unit: 1.0
    nl:
      - "Wait for {n} ticks"
      - "Pause {n} ticks"
      - "Idle for {n} ticks"
    outcomes:
      - name: noop
        status: success
        p: 1.00
        when: []
        add: []
        delete: []
        messages:
          - "Waited {n} ticks."
      - name: fail
        status: fail
        p: 0.00
        when: []
        add: []
        delete: []
        messages:
          - "Nothing happened."

  - name: move
    params: [{r: robot}, {from: location}, {to: location}]
    pre:
      - "(at ?r ?from)"
      - "(adjacent ?from ?to)"
      - "(>= (energy ?r) 1)"
      - "(distinct ?from ?to)"
    add: []
    del: []
    duration: 1.0
    nl:
      - "Move {r} from {from} to {to}"
      - "Go from {from} to {to} with {r}"
      - "{r} moves {from} → {to}"
    outcomes:
      - name: stuck
        status: fail
        p: 0.05
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "{r} tried to move from {from} to {to} but got stuck. No progress."
      - name: arrive
        status: success
        p: 0.95
        when: []
        add: ["(at ?r ?to)"]
        delete: ["(at ?r ?from)"]
        num_eff: ["(decrease (energy ?r) 1)"]
        messages:
          - "{r} moved from {from} to {to}. Energy is now (energy ?r)."

  - name: open
    params: [{r: robot}, {c: container}]
    pre: ["(co-located ?r ?c)", "(openable ?c)", "(not (open ?c))"]
    add: []
    del: []
    duration: 0.5
    nl:
      - "Open {c}"
      - "{r} opens {c}"
      - "Open the {c}"
    outcomes:
      - name: fumble
        status: fail
        p: 0.05
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "You fumbled with {c}. Still closed."
      - name: opened
        status: success
        p: 0.95
        when: []
        add: ["(open ?c)"]
        delete: []
        num_eff: ["(decrease (energy ?r) 0.2)"]
        messages:
          - "{c} is now open."

  - name: close
    params: [{r: robot}, {c: container}]
    pre: ["(co-located ?r ?c)", "(openable ?c)", "(open ?c)"]
    add: []
    del: []
    duration: 0.5
    nl:
      - "Close {c}"
      - "{r} closes {c}"
      - "Shut {c}"
    outcomes:
      - name: unlatch
        status: fail
        p: 0.05
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "You tried to close {c} but it didn’t latch."
      - name: closed
        status: success
        p: 0.95
        when: []
        add: []
        delete: ["(open ?c)"]
        num_eff: ["(decrease (energy ?r) 0.2)"]
        messages:
          - "{c} is now closed."

  - name: pick-up
    params: [{r: robot}, {o: movable}]
    pre: ["(co-located ?r ?o)", "(clear-hand ?r)"]
    add: []
    del: []
    duration: 0.5
    nl:
      - "Pick up {o}"
      - "{r} picks up {o}"
      - "Grab {o}"
    outcomes:
      - name: drop
        status: fail
        p: 0.10
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "You fumbled {o}. Try again."
      - name: holding
        status: success
        p: 0.90
        when: []
        add: ["(holding ?r ?o)"]
        delete: ["(obj-at ?o ?l)", "(clear-hand ?r)", "(on-stove ?o ?s)"]
        num_eff: ["(decrease (energy ?r) 0.3)"]
        messages:
          - "Picked up {o}."

  - name: put-down
    params: [{r: robot}, {o: movable}]
    pre: ["(holding ?r ?o)"]
    add: []
    del: []
    duration: 0.5
    nl:
      - "Put down {o}"
      - "{r} puts down {o}"
      - "Place {o} down"
    outcomes:
      - name: slip
        status: fail
        p: 0.07
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "{o} slipped; still in hand."
      - name: placed
        status: success
        p: 0.93
        when: []
        add: ["(obj-at ?o ?l)", "(clear-hand ?r)"]
        delete: ["(holding ?r ?o)", "(on-stove ?o ?s)"]
        num_eff: ["(decrease (energy ?r) 0.3)"]
        messages:
          - "Placed {o} down."

  - name: put-in
    params: [{r: robot}, {o: movable}, {c: container}]
    pre:
      - "(co-located ?r ?c)"
      - "(holding ?r ?o)"
      - "(or (not (openable ?c)) (open ?c))"
    add: []
    del: []
    duration: 0.5
    nl:
      - "Put {o} into {c}"
      - "{r} inserts {o} into {c}"
      - "Place {o} in {c}"
    outcomes:
      - name: miss
        status: fail
        p: 0.10
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "Missed the opening on {c}. Try again."
      - name: inserted
        status: success
        p: 0.90
        when: []
        add: ["(in ?o ?c)", "(clear-hand ?r)"]
        delete: ["(holding ?r ?o)", "(obj-at ?o ?l)", "(on-stove ?o ?s)"]
        num_eff: ["(decrease (energy ?r) 0.3)"]
        messages:
          - "{o} is now in {c}."

  - name: take-out
    params: [{r: robot}, {o: movable}, {c: container}]
    pre:
      - "(clear-hand ?r)"
      - "(co-located ?r ?c)"
      - "(in ?o ?c)"
      - "(or (not (openable ?c)) (open ?c))"
    add: []
    del: []
    duration: 0.5
    nl:
      - "Take {o} out of {c}"
      - "{r} removes {o} from {c}"
      - "Retrieve {o} from {c}"
    outcomes:
      - name: fail_grip
        status: fail
        p: 0.10
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "You couldn’t get a grip on {o} in {c}."
      - name: retrieved
        status: success
        p: 0.90
        when: []
        add: ["(holding ?r ?o)"]
        delete: ["(in ?o ?c)", "(clear-hand ?r)"]
        num_eff: ["(decrease (energy ?r) 0.3)"]
        messages:
          - "Took {o} out of {c}."

  - name: power-on
    params: [{r: robot}, {a: appliance}]
    pre: ["(co-located ?r ?a)", "(not (powered ?a))"]
    add: []
    del: []
    duration: 0.5
    nl:
      - "Power on {a}"
      - "{r} turns on {a}"
      - "Switch on {a}"
    outcomes:
      - name: no_click
        status: fail
        p: 0.02
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.05)"]
        messages:
          - "Power button on {a} didn’t register."
      - name: powered_on
        status: success
        p: 0.98
        when: []
        add: ["(powered ?a)"]
        delete: []
        num_eff: ["(decrease (energy ?r) 0.2)"]
        messages:
          - "{a} is now powered."

  - name: power-off
    params: [{r: robot}, {a: appliance}]
    pre: ["(co-located ?r ?a)", "(powered ?a)"]
    add: []
    del: []
    duration: 0.5
    nl:
      - "Power off {a}"
      - "{r} turns off {a}"
      - "Switch off {a}"
    outcomes:
      - name: power_fail
        status: fail
        p: 0.05
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.05)"]
        messages:
          - "Power button on {a} didn’t respond."
      - name: powered_off
        status: success
        p: 0.95
        when: []
        add: []
        delete: ["(powered ?a)", "(burner-on ?a)"]
        num_eff: ["(decrease (energy ?r) 0.15)"]
        messages:
          - "{a} is now powered off."

  - name: place-on-stove
    params: [{r: robot}, {c: cookware}, {s: stove}]
    pre: ["(holding ?r ?c)", "(co-located ?r ?s)"]
    add: []
    del: []
    duration: 0.5
    nl:
      - "Place {c} on {s}"
      - "{r} sets {c} on {s}"
      - "Put {c} onto {s}"
    outcomes:
      - name: slip
        status: fail
        p: 0.08
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "{c} slipped; still in hand."
      - name: placed_on_stove
        status: success
        p: 0.92
        when: []
        add: ["(on-stove ?c ?s)", "(obj-at ?c ?l)", "(clear-hand ?r)"]
        delete: ["(holding ?r ?c)"]
        num_eff: ["(decrease (energy ?r) 0.2)"]
        messages:
          - "{c} is now on {s}."

  - name: ignite-stove
    params: [{r: robot}, {s: stove}]
    pre: ["(co-located ?r ?s)", "(powered ?s)", "(not (burner-on ?s))"]
    add: []
    del: []
    duration: 0.5
    nl:
      - "Ignite {s}"
      - "{r} ignites {s}"
      - "Turn on the burner on {s}"
    outcomes:
      - name: no_ignite
        status: fail
        p: 0.06
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.05)"]
        messages:
          - "{s} did not ignite."
      - name: burner_on
        status: success
        p: 0.94
        when: []
        add: ["(burner-on ?s)"]
        delete: []
        num_eff: ["(decrease (energy ?r) 0.2)"]
        messages:
          - "{s} burner is now on."

  - name: extinguish-stove
    params: [{r: robot}, {s: stove}]
    pre: ["(co-located ?r ?s)", "(burner-on ?s)"]
    add: []
    del: []
    duration: 0.5
    nl:
      - "Extinguish {s}"
      - "{r} turns off the burner on {s}"
      - "Shut down {s}"
    outcomes:
      - name: fail_to_extinguish
        status: fail
        p: 0.05
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.05)"]
        messages:
          - "{s} burner did not shut off."
      - name: burner_off
        status: success
        p: 0.95
        when: []
        add: []
        delete: ["(burner-on ?s)"]
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "{s} burner is now off."

  - name: heat-stove
    params: [{r: robot}, {s: stove}, {n: number}]
    pre: ["(co-located ?r ?s)", "(burner-on ?s)"]
    add: []
    del: []
    duration_var: "n"
    duration_unit: 0.5
    nl:
      - "Heat {s} for {n} ticks (+40°C per tick)"
      - "Run {s} for {n} ticks (+40°C per tick)"
      - "Preheat {s} for {n} ticks"
    outcomes:
      - name: heat_fail
        status: fail
        p: 0.05
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "{s} did not heat as expected."
      - name: heat_ok
        status: success
        p: 0.95
        when: []
        add: []
        delete: []
        num_eff: ["(increase (surface-temp ?s) 40*?n)", "(decrease (energy ?r) 0.3)"]
        messages:
          - "{s} surface temperature is now (surface-temp ?s)°C."

  - name: cool-stove
    params: [{r: robot}, {s: stove}, {n: number}]
    pre: ["(co-located ?r ?s)", "(not (burner-on ?s))"]
    add: []
    del: []
    duration_var: "n"
    duration_unit: 0.5
    nl:
      - "Cool {s} for {n} ticks (-30°C per tick)"
      - "Let {s} cool for {n} ticks"
      - "Cool down {s}"
    outcomes:
      - name: cool_fail
        status: fail
        p: 0.05
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.05)"]
        messages:
          - "{s} did not cool as expected."
      - name: cool_ok
        status: success
        p: 0.95
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (surface-temp ?s) 30*?n)", "(decrease (energy ?r) 0.1)"]
        messages:
          - "{s} surface temperature is now (surface-temp ?s)°C."

  - name: heat-on-stove
    params: [{r: robot}, {c: container}, {s: stove}, {n: number}]
    pre:
      - "(co-located ?r ?s)"
      - "(on-stove ?c ?s)"
      - "(burner-on ?s)"
      - "(hot-surface ?s)"
      - "(has-water ?c)"
    add: []
    del: []
    duration_var: "n"
    duration_unit: 0.5
    nl:
      - "Heat {c} on {s} for {n} ticks (+20°C per tick)"
      - "Warm {c} on {s} for {n} ticks"
      - "Simmer {c} on {s}"
    outcomes:
      - name: heat_fail
        status: fail
        p: 0.06
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "Heating {c} on {s} failed to start."
      - name: heat_ok
        status: success
        p: 0.94
        when: []
        add: []
        delete: []
        num_eff: ["(increase (water-temp ?c) 20*?n)", "(decrease (energy ?r) 0.3)"]
        messages:
          - "Water temperature in {c} is now (water-temp ?c)°C."

  - name: cook-on-stove
    params: [{r: robot}, {f: food}, {c: cookware}, {s: stove}, {n: number}]
    pre:
      - "(co-located ?r ?s)"
      - "(on-stove ?c ?s)"
      - "(burner-on ?s)"
      - "(hot-surface ?s)"
      - "(in ?f ?c)"
    add: []
    del: []
    duration_var: "n"
    duration_unit: 0.5
    nl:
      - "Cook {f} in {c} on {s} for {n} ticks"
      - "Heat {f} on {s} for {n} ticks"
      - "Cook {f} on {s}"
    outcomes:
      - name: cook_fail
        status: fail
        p: 0.08
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "{f} did not cook evenly."
      - name: cook_ok
        status: success
        p: 0.92
        when: []
        add: []
        delete: []
        num_eff: ["(increase (food-temp ?f) 25*?n)", "(decrease (energy ?r) 0.3)"]
        messages:
          - "{f} temperature is now (food-temp ?f)°C."

  - name: fill-water
    params: [{r: robot}, {k: container}, {s: container}]
    pre:
      - "(co-located ?r ?k)"
      - "(co-located ?r ?s)"
      - "(is-sink ?s)"
      - "(or (not (openable ?k)) (open ?k))"
    add: []
    del: []
    duration: 1.0
    nl:
      - "Fill {k} with water from {s}"
      - "{r} fills {k} at {s}"
    outcomes:
      - name: sputter
        status: fail
        p: 0.05
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.1)"]
        messages:
          - "The faucet sputtered; {k} didn’t fill."
      - name: filled
        status: success
        p: 0.95
        when: []
        add: ["(has-water ?k)"]
        delete: ["(has-hot-water ?k)"]
        num_eff:
          - "(assign (water-temp ?k) 20)"
          - "(decrease (energy ?r) 0.2)"
        messages:
          - "{k} is now filled with water (20°C)."

  - name: heat-kettle
    params: [{r: robot}, {k: appliance}, {n: number}]
    pre:
      - "(co-located ?r ?k)"
      - "(powered ?k)"
      - "(has-water ?k)"
      - "(not (open ?k))"
    add: []
    del: []
    duration_var: "n"
    duration_unit: 0.5
    nl:
      - "Heat {k} for {n} ticks (each tick increases water temp by 15°C)"
      - "Run {k} for {n} ticks (+15°C per tick)"
      - "Heat cycle on {k}: {n} ticks"
    outcomes:
      - name: heat_fail
        status: fail
        p: 0.05
        when: []
        add: []
        delete: []
        num_eff: []
        messages:
          - "Heating cycle on {k} failed to start."
      - name: heat_ok
        status: success
        p: 0.95
        when: []
        add: []
        delete: []
        num_eff: ["(increase (water-temp ?k) 15*?n)"]
        messages:
          - "Heating {k}. Water temperature is now (water-temp ?k)°C."

  - name: pour
    params: [{r: robot}, {k: container}, {m: container}]
    pre:
      - "(co-located ?r ?k)"
      - "(co-located ?r ?m)"
      - "(has-water ?k)"
      - "(distinct ?k ?m)"
      # source-side role constraints
      - "(or (not (pour-out-needs-open ?k)) (open ?k))"
      - "(or (not (pour-out-needs-closed ?k)) (not (open ?k)))"
    duration: 1.0
    nl:
      - "Pour from {k} into {m}"
      - "{r} pours {k} into {m}"
      - "Transfer water {k} → {m}"
    outcomes:
      # spill if target requires open but is closed; water leaves source and is lost
      - name: spill_closed_target
        status: success
        p: 1.0
        when:
          - "(pour-in-needs-open ?m)"
          - "(not (open ?m))"
        add: ["(spilled ?m)"]
        delete: ["(has-water ?k)", "(has-hot-water ?k)"]
        messages:
          - "Tried to pour into {m} while closed — water spilled."

      # block if target requires closed but is open (treat as fail, not spill)
      - name: blocked_target_requires_closed_but_open
        status: fail
        p: 1.0
        when:
          - "(pour-in-needs-closed ?m)"
          - "(open ?m)"
        add: []
        delete: []
        messages:
          - "{m} must be closed to pour into it."

      # success with hot transfer (mirror temp; move water)
      - name: transfer_hot
        status: success
        p: 1.0
        when:
        - "(or (not (pour-in-needs-open ?m)) (open ?m))"
        - "(>= (water-temp ?k) 80)"
        add: ["(has-water ?m)", "(has-hot-water ?m)"]
        delete: ["(spilled ?m)", "(has-water ?k)", "(has-hot-water ?k)"]
        num_eff:
          - "(assign (water-temp ?m) (water-temp ?k))"
        messages:
          - "Hot water transferred to {m}."

      # success with cool transfer
      - name: transfer_cool
        status: success
        p: 1.0
        when:
          - "(or (not (pour-in-needs-open ?m)) (open ?m))"
          - "(< (water-temp ?k) 80)"
        add: ["(has-water ?m)"]
        delete: ["(spilled ?m)", "(has-hot-water ?m)", "(has-water ?k)", "(has-hot-water ?k)"]
        num_eff:
          - "(assign (water-temp ?m) (water-temp ?k))"
        messages:
          - "Water transferred to {m} (not hot)."

  - name: steep-tea
    params: [{r: robot}, {tb: movable}, {m: container}]
    pre: ["(co-located ?r ?m)", "(in ?tb ?m)", "(>= (water-temp ?m) 80)"]
    add: []
    del: []
    duration: 2.0
    nl:
      - "Steep tea in {m} (requires water ≥80°C)"
      - "Steep {tb} in {m} (water ≥80°C)"
      - "Brew tea in {m} (≥80°C)"
    outcomes:
      - name: steep_fail
        status: fail
        p: 0.08
        when: []
        add: []
        delete: []
        num_eff: ["(decrease (energy ?r) 0.2)"]
        messages:
          - "Steeping failed—bag tore or drifted. Try again."
      - name: steep_ok
        status: success
        p: 0.92
        when: []
        add: ["(tea-ready ?m)"]
        delete: ["(spilled ?m)"]
        num_eff: ["(decrease (energy ?r) 0.5)"]
        messages:
          - "Tea steeped. {m} is ready."

  - name: recharge
    params: [{r: robot}, {l: location}]
    pre: ["(at ?r ?l)", "(has-charger ?l)"]
    add: []
    del: []
    duration: 2.0
    nl:
      - "Recharge at {l}"
      - "{r} recharges at {l}"
      - "Use charger at {l}"
    outcomes:
      - name: recharge_fail
        status: fail
        p: 0.02
        when: []
        add: []
        delete: []
        num_eff: []
        messages:
          - "Charger at {l} didn’t connect properly."
      - name: recharge_ok
        status: success
        p: 0.98
        when: []
        add: []
        delete: []
        num_eff: ["(increase (energy ?r) 5)"]
        messages:
          - "{r} recharged at {l}. Energy is now (energy ?r)."
