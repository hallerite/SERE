id: t03_open_thermos_pour_steep
name: Three steps; open thermos, pour, steep
description: |
  The thermos is closed. Kettle is hot & open; teabag is already in the thermos.

meta:
  domain: kitchen
  enable_numeric: true
  enable_conditional: true
  enable_durations: true
  max_steps: 10
  time_limit: 6.5
  seed: 203
  init_fluents:
    - ["battery-cap", ["robot"], 8]
    - ["energy", ["robot"], 8]
    - ["water-temp", ["heater"], 90.0]
  reward_shaping:
    mode: instant
    milestones:
      - {expr: "(open thermos)", reward: 0.10, once: true}
      - {expr: "(has-hot-water thermos)", reward: 0.10, once: true}
  clutter:
    budget: {min: 1, max: 3}
    items:
      - name: coaster
        types: [object]
        variants: [coaster1, coaster2]
        at: [room]
        count: {min: 0, max: 2}
      - name: rag
        types: [object]
        at: [room]
        count: {min: 0, max: 2}

objects:
  robot:
    types: [robot]
    variants: [r1]
  room:
    types: [location]
    variants: [kitchen]
  thermos:
    types: [container]
    variants: [thermos1, thermos, flask, tumbler]
  heater:
    types: [container, appliance]
    variants: [kettle1, kettle, boiler, samovar, urn]
  sachet:
    types: [object]
    variants: [teabag1, sachet, bag]

static_facts:
  - (needs-open thermos)
  - (openable thermos)
  - (openable heater)

init:
  - (at robot room)
  - (obj-at thermos room)
  - (obj-at heater room)
  - (open heater)
  - (in sachet thermos)
  - (clear-hand robot)

termination:
  - name: goal
    when: "(tea-ready thermos)"
    outcome: success
    reward: 1.0
  - name: spill_fail
    when: "(spilled thermos)"
    outcome: failure
    reward: -0.4

reference_plan:
  - (open robot thermos)
  - (pour robot heater thermos)
  - (steep-tea robot sachet thermos)