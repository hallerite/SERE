# tasks/kitchen/t09_energy_gate_recharge_once.yaml
id: t09_energy_gate_recharge_once
name: Energy gate; recharge once
description: |
  Low starting energy requires one recharge at the hallway charger to complete the brew and move to table.

meta:
  domain: kitchen
  enable_numeric: true
  enable_conditional: true
  enable_durations: true
  max_steps: 50
  seed: 209
  init_fluents:
    - ["energy", ["r1"], 1]
    - ["water-temp", ["kettle1"], 60.0]
  reward_shaping:
    mode: instant
    milestones:
      - {expr: "(>= (energy r1) 5)",           reward: 0.05, once: true}   # recharge happened
      - {expr: "(>= (water-temp kettle1) 80)", reward: 0.10, once: true}
      - {expr: "(in teabag1 mug1)",            reward: 0.05, once: true}
      - {expr: "(has-hot-water mug1)",         reward: 0.10, once: true}


objects:
  robot: [r1]
  location: [hallway, kitchen, pantry, table]
  container: [mug1, kettle1]
  appliance: [kettle1]
  object: [teabag1]

static_facts:
  - (has-charger hallway)
  - (adjacent hallway kitchen)
  - (adjacent kitchen hallway)
  - (adjacent kitchen pantry)
  - (adjacent pantry kitchen)
  - (adjacent kitchen table)
  - (adjacent table kitchen)
  - (openable kettle1)

init:
  - (at r1 hallway)
  - (obj-at kettle1 kitchen)
  - (powered kettle1)
  - (obj-at mug1 kitchen)
  - (obj-at teabag1 pantry)
  - (clear-hand r1)

goal:
  - (tea-ready mug1)
  - (at r1 table)

reference_plan:
  - (recharge r1 hallway)           # +5 energy
  - (move r1 hallway kitchen)
  - (heat-kettle r1 kettle1 3)
  - (move r1 kitchen pantry)
  - (pick-up r1 teabag1)
  - (move r1 pantry kitchen)
  - (put-in r1 teabag1 mug1)
  - (pour r1 kettle1 mug1)
  - (steep-tea r1 teabag1 mug1)
  - (move r1 kitchen table)
